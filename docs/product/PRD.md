# PRD: Google ビジネス プロフィール（GBP）運用基盤

## 背景 / 課題
- 多拠点（ロケーション）の営業時間・属性・写真・投稿・レビュー対応など、運用負荷が高い。
- 変更の承認・監査・ロール管理が曖昧になりがちで、事故防止が課題。
- バッチ更新や同時並行編集での衝突、公開反映までの可視化が不足。

## ゴール（MVP）
- Google OAuth 連携済みアカウントで、GBPのロケーション情報を取得・表示できる。
- 代表的な編集（例: 営業時間/特別営業時間・電話番号・URL・ビジネス説明）を申請→承認→反映できる。
- 変更は監査ログに記録され、元に戻せる（履歴参照）。

## 対象ユーザ
- 管理者（運用責任者）: 権限付与・承認・監査
- オペレーター（現場/代理店）: 編集の提案/申請

## ユースケース（主要）
1) ロケーション一覧→検索/絞り込み→詳細表示
2) 詳細から編集提案（営業時間/特別営業時間/電話/URL/説明/カテゴリ/属性）→申請
3) 申請一覧→差分確認→承認/却下→同期（即時 or バッチ）
4) 監査ログの参照（いつ/誰が/何を）
5) 成果の可視化（同期結果、エラー、未検証ロケーション）

## スコープ（MVP）
- 取得/編集対象（優先度高）
  - 基本: 名称、カテゴリ、ビジネス説明、電話、Website、メインアドレス、サービス提供エリア
  - 営業時間: 通常営業時間、特別営業時間（祝日等）
  - URL群: 予約/メニュー/注文/テイクアウト/デリバリー等のサブURL
  - 属性: アクセシビリティ/支払い/設備/ヘルス&セーフティ（カテゴリ依存の汎用属性）
- 変更申請/承認/同期（ロール: admin/operator）
- 監査ログ・履歴（DB + 画面参照）

## 非スコープ（MVP外、将来）
- 写真/ロゴの管理、投稿（Posts）、Q&A、レビュー返信
- 商品/サービス掲載、メニュー詳細管理、イベント/オファー投稿
- 予約連携（外部パートナー）、メッセージ（チャット）
- 大規模一括（CSV）インポート/エクスポート

## 成功指標
- ロケーションN件に対し、重要項目の編集→承認→同期がエラー<5%で完了
- 変更承認リードタイム短縮（例: 1営業日→当日）

## 制約 / リスク
- GBP APIの利用制限（レート/割当、カテゴリ別の属性差）
- 実ロケーションの検証/権限要件
- セキュリティ: トークン/個人情報の安全管理（暗号化、RLS、監査）

## 技術ハイレベル
- フロント: Next.js（将来） or 現在は最小HTMLで縦切り
- サーバ: Node.js（OAuth・APIゲートウェイ）
- データ: Supabase（RLS/監査/キュー準備）
- ジョブ: pg-boss（将来のバッチ/再試行）

